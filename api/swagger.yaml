basePath: /api/v1
definitions:
  dto.AddressDTO:
    properties:
      country:
        type: string
      municipality:
        type: string
      neighborhood:
        type: string
      province:
        type: string
      zipCode:
        type: string
    type: object
  dto.Alert:
    properties:
      latitude:
        type: number
      longitude:
        type: number
      message:
        type: string
      radius:
        type: number
      risk_topic_id:
        type: string
      risk_type_id:
        type: string
      severity:
        type: string
      user_id:
        type: string
    type: object
  dto.DeviceResponse:
    properties:
      alert_radius_meters:
        type: integer
      device_id:
        type: string
      fcm_token:
        type: string
      latitude:
        type: number
      longitude:
        type: number
      message:
        type: string
      platform:
        type: string
    type: object
  dto.ListReportsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/dto.ReportDTO'
        type: array
      pagination:
        $ref: '#/definitions/dto.PaginationMetadata'
    type: object
  dto.LoginInput:
    properties:
      email:
        type: string
      password:
        type: string
    type: object
  dto.NearbyReportsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/dto.ReportWithDistance'
        type: array
    type: object
  dto.PaginationMetadata:
    properties:
      has_more:
        type: boolean
      has_previous:
        type: boolean
      limit:
        type: integer
      page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  dto.RegisterDeviceRequest:
    properties:
      alert_radius_meters:
        type: integer
      device_id:
        minLength: 16
        type: string
      fcm_token:
        type: string
      language:
        type: string
      latitude:
        type: number
      longitude:
        type: number
      model:
        type: string
      platform:
        enum:
        - ios
        - android
        - web
        type: string
    required:
    - device_id
    type: object
  dto.RegisterUserInput:
    properties:
      email:
        type: string
      name:
        type: string
      password:
        type: string
      phone:
        type: string
    type: object
  dto.RegisterUserOutput:
    properties:
      id:
        type: string
    type: object
  dto.ReportCreate:
    properties:
      address:
        type: string
      description:
        type: string
      image_url:
        type: string
      latitude:
        type: number
      longitude:
        type: number
      municipality:
        type: string
      neighborhood:
        type: string
      province:
        type: string
      risk_topic_id:
        type: string
      risk_type_id:
        type: string
      user_id:
        type: string
    type: object
  dto.ReportDTO:
    properties:
      address:
        type: string
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      image_url:
        type: string
      latitude:
        type: number
      longitude:
        type: number
      municipality:
        type: string
      neighborhood:
        type: string
      province:
        type: string
      resolved_at:
        type: string
      reviewed_by:
        type: string
      risk_topic_id:
        type: string
      risk_type_id:
        type: string
      status:
        type: string
      updated_at:
        type: string
      user_id:
        type: string
    type: object
  dto.ReportWithDistance:
    properties:
      address:
        type: string
      created_at:
        type: string
      description:
        type: string
      distance:
        description: Distance in meters
        type: number
      id:
        type: string
      image_url:
        type: string
      latitude:
        type: number
      longitude:
        type: number
      municipality:
        type: string
      neighborhood:
        type: string
      province:
        type: string
      resolved_at:
        type: string
      reviewed_by:
        type: string
      risk_topic_id:
        type: string
      risk_type_id:
        type: string
      status:
        type: string
      updated_at:
        type: string
      user_id:
        type: string
    type: object
  dto.ResolveReportRequest:
    properties:
      moderator_id:
        type: string
    required:
    - moderator_id
    type: object
  dto.RiskTopicResponse:
    properties:
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      name:
        type: string
      risk_type_id:
        type: string
      updated_at:
        type: string
    type: object
  dto.RiskTopicsListResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/dto.RiskTopicResponse'
        type: array
    type: object
  dto.RiskTypeResponse:
    properties:
      created_at:
        type: string
      default_radius:
        type: integer
      description:
        type: string
      id:
        type: string
      name:
        type: string
      updated_at:
        type: string
    type: object
  dto.RiskTypesListResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/dto.RiskTypeResponse'
        type: array
    type: object
  dto.UpdateDeviceLocationRequest:
    properties:
      device_id:
        type: string
      latitude:
        type: number
      longitude:
        type: number
    required:
    - device_id
    - latitude
    - longitude
    type: object
  dto.UpdateReportLocationRequest:
    properties:
      address:
        type: string
      latitude:
        maximum: 90
        minimum: -90
        type: number
      longitude:
        maximum: 180
        minimum: -180
        type: number
      municipality:
        type: string
      neighborhood:
        type: string
      province:
        type: string
    required:
    - latitude
    - longitude
    type: object
  dto.UpdateReportLocationResponse:
    properties:
      id:
        type: string
      message:
        type: string
      updated_at:
        type: string
    type: object
  dto.UserProfileOutput:
    properties:
      address:
        $ref: '#/definitions/dto.AddressDTO'
      email:
        type: string
      id:
        type: string
      name:
        type: string
      nif:
        type: string
      phone:
        type: string
      role_name:
        items:
          type: string
        type: array
    type: object
  dto.UserProfileResponse:
    properties:
      active_role:
        type: string
      email:
        type: string
      id:
        type: string
      name:
        type: string
      role_name:
        items:
          type: string
        type: array
    type: object
  dto.UserSignInDTO:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
      user:
        $ref: '#/definitions/dto.UserProfileResponse'
    type: object
  dto.VerifyReportRequest:
    properties:
      moderator_id:
        type: string
    required:
    - moderator_id
    type: object
  util.ErrorResponse:
    properties:
      error:
        properties:
          code:
            type: integer
          message: {}
        type: object
      success:
        type: boolean
    type: object
info:
  contact:
    email: support@riskplace.ao
    name: API Support
    url: http://www.riskplace.ao
  description: |-
    This is the API documentation for the Risk Place Angola application.

    ## Environments
    - **Development**: https://risk-place-angola-904a.onrender.com
    - **Local**: http://localhost:8000

    ## WebSocket Integration Guide
    For detailed instructions on integrating WebSocket in mobile applications, please refer to our [WebSocket Notification Guide](https://github.com/risk-place-angola/backend-risk-place/blob/develop/docs/MOBILE_WEBSOCKET_INTEGRATION.md)
  title: Risk Place Angola API
  version: 1.0.0
paths:
  /alerts:
    post:
      consumes:
      - application/json
      description: Create a new alert.
      parameters:
      - description: Alert
        in: body
        name: alert
        required: true
        schema:
          $ref: '#/definitions/dto.Alert'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.Alert'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create a new alert.
      tags:
      - alerts
  /api/v1/devices/location:
    put:
      consumes:
      - application/json
      description: Update the location of an anonymous device for proximity-based
        notifications
      parameters:
      - description: Location update data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateDeviceLocationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Update device location
      tags:
      - devices
  /api/v1/devices/register:
    post:
      consumes:
      - application/json
      description: Register or update an anonymous device for receiving notifications
        without authentication
      parameters:
      - description: Device registration data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RegisterDeviceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.DeviceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Register anonymous device
      tags:
      - devices
  /auth/confirm:
    post:
      consumes:
      - application/json
      description: Confirm user signup using the verification code
      parameters:
      - description: Signup confirmation data
        in: body
        name: confirmation
        required: true
        schema:
          properties:
            code:
              type: string
            email:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "204":
          description: signup confirmed successfully
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Confirm user signup
      tags:
      - auth
  /auth/login:
    post:
      consumes:
      - application/json
      description: Login a user
      parameters:
      - description: User login credentials
        in: body
        name: credentials
        required: true
        schema:
          $ref: '#/definitions/dto.LoginInput'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.UserSignInDTO'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Login a user
      tags:
      - auth
  /auth/password/forgot:
    post:
      consumes:
      - application/json
      description: Send a password reset code to the user's email
      parameters:
      - description: User email
        in: body
        name: email
        required: true
        schema:
          properties:
            email:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: password reset code sent
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Initiate password reset
      tags:
      - auth
  /auth/password/reset:
    post:
      consumes:
      - application/json
      description: Reset user password using the reset code
      parameters:
      - description: Password reset data
        in: body
        name: reset
        required: true
        schema:
          properties:
            email:
              type: string
            password:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: password reset successfully
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Reset user password
      tags:
      - auth
  /auth/signup:
    post:
      consumes:
      - application/json
      description: Register a new user
      parameters:
      - description: User registration data
        in: body
        name: user
        required: true
        schema:
          $ref: '#/definitions/dto.RegisterUserInput'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.RegisterUserOutput'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Register a new user
      tags:
      - auth
  /reports:
    get:
      consumes:
      - application/json
      description: List all reports in the system with pagination and filters
      parameters:
      - description: 'Page number (default: 1)'
        in: query
        name: page
        type: integer
      - description: 'Items per page (default: 20, max: 100)'
        in: query
        name: limit
        type: integer
      - description: Filter by status (pending, verified, resolved)
        in: query
        name: status
        type: string
      - description: 'Sort field (default: created_at)'
        in: query
        name: sort
        type: string
      - description: 'Sort order (asc, desc) (default: desc)'
        in: query
        name: order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.ListReportsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List all reports with pagination
      tags:
      - reports
    post:
      consumes:
      - application/json
      description: Create a new report
      parameters:
      - description: Report to create
        in: body
        name: report
        required: true
        schema:
          $ref: '#/definitions/dto.ReportCreate'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.ReportDTO'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create a new report
      tags:
      - reports
  /reports/{id}/location:
    put:
      consumes:
      - application/json
      description: Update the geographic location of a report (used when user drags
        marker on map)
      parameters:
      - description: Report ID
        in: path
        name: id
        required: true
        type: string
      - description: New location data
        in: body
        name: location
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateReportLocationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.UpdateReportLocationResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update report location
      tags:
      - reports
  /reports/{id}/resolve:
    post:
      consumes:
      - application/json
      description: Resolve a report by its ID
      parameters:
      - description: Report ID
        in: path
        name: id
        required: true
        type: string
      - description: Resolution data
        in: body
        name: resolve
        required: true
        schema:
          $ref: '#/definitions/dto.ResolveReportRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Resolve a report
      tags:
      - reports
  /reports/{id}/verify:
    post:
      consumes:
      - application/json
      description: Verify a report by its ID
      parameters:
      - description: Report ID
        in: path
        name: id
        required: true
        type: string
      - description: Verification data
        in: body
        name: verify
        required: true
        schema:
          $ref: '#/definitions/dto.VerifyReportRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Verify a report
      tags:
      - reports
  /reports/nearby:
    get:
      consumes:
      - application/json
      description: List reports near the specified location with calculated distance
      parameters:
      - description: Latitude
        in: query
        name: latitude
        required: true
        type: number
      - description: Longitude
        in: query
        name: longitude
        required: true
        type: number
      - description: Radius in meters
        in: query
        name: radius
        required: true
        type: number
      - description: 'Maximum number of results (default: 50)'
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.NearbyReportsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List nearby reports with distance
      tags:
      - reports
  /risks/topics:
    get:
      consumes:
      - application/json
      description: Retrieve risk topics, optionally filtered by risk_type_id query
        parameter.
      parameters:
      - description: Filter by risk type ID (UUID)
        in: query
        name: risk_type_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.RiskTopicsListResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: List risk topics.
      tags:
      - risks
  /risks/topics/{id}:
    get:
      consumes:
      - application/json
      description: Retrieve a specific risk topic by its UUID
      parameters:
      - description: Risk Topic ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.RiskTopicResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get a risk topic by ID
      tags:
      - risks
  /risks/types:
    get:
      consumes:
      - application/json
      description: Retrieve all available risk types with their default radius.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.RiskTypesListResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: List all risk types.
      tags:
      - risks
  /risks/types/{id}:
    get:
      consumes:
      - application/json
      description: Retrieve a specific risk type by its UUID
      parameters:
      - description: Risk Type ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.RiskTypeResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get a risk type by ID
      tags:
      - risks
  /users/me:
    get:
      consumes:
      - application/json
      description: Get information about the currently authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.UserProfileOutput'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current user info
      tags:
      - users
  /ws/alerts:
    get:
      description: Upgrade HTTP connection to WebSocket for real-time alerts. Supports
        both authenticated (JWT) and anonymous (device_id) connections
      parameters:
      - description: Device ID for anonymous users
        in: header
        name: X-Device-ID
        type: string
      responses:
        "101":
          description: Switching Protocols
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Handle WebSocket connections for alerts
      tags:
      - websocket
securityDefinitions:
  BearerAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
